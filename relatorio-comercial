#include "protheus.ch"
#include "file.ch"

/*-----------------------------------------------------------
  Function: ImporArq()
  Description: Exemplo de importação de arquivo
  Author: [Seu nome]
  Date: [Data]
  Param: N/A
  Return: N/A
-----------------------------------------------------------*/
User Function ImporArq()
    Local cArqPath
    Local nHandle
    Local cLinha
    Local aCampos

    // 1. Permite que o usuário selecione o arquivo
    cArqPath := cGetFile("*.txt", "Selecione o arquivo para importar")

    If Empty(cArqPath)
        MsgInfo("Importação cancelada pelo usuário.", "Aviso")
        Return .F.
    EndIf

    // 2. Tenta abrir o arquivo para leitura
    nHandle := FOpen(cArqPath)

    If nHandle < 0
        MsgStop("Não foi possível abrir o arquivo.", "Erro")
        Return .F.
    EndIf

    // 3. Lê o arquivo linha por linha
    While !FEof(nHandle)
        cLinha := FGetC(nHandle)

        // Pula a linha se estiver vazia
        If Empty(cLinha)
            Loop
        EndIf

        // 4. Processa a linha (exemplo: separa por vírgula)
        aCampos := FWcToA(cLinha, ",")

        // 5. Grava os dados na tabela (exemplo: SA1 - Clientes)
        // DbSelectArea("SA1")
        // MsNew()
        // SA1->A1_COD := aCampos[1]
        // SA1->A1_NOME := aCampos[2]
        // DbCommit()
    EndDo

    // Fecha o arquivo
    FClose(nHandle)

    MsgInfo("Arquivo importado com sucesso!", "Sucesso")

Return .T.
